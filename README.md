# AuraTime

マルチテナント型勤怠・給与管理システム

## 概要

AuraTimeは、中規模〜大規模組織をターゲットとした、セキュアでスケーラブルなマルチテナント型「勤怠・給与管理システム」です。組織の複雑な構造（部署、チーム、プロジェクト、コストセンター）に柔軟に対応し、正確な労働時間の集計から給与計算、支払管理までを一気通貫でサポートします。

## 主な機能

- **勤怠管理**: Web/モバイル/ICカードによる打刻、日次集計、シフト管理
- **休暇管理**: 各種休暇（有給・特休等）の申請・承認、残数管理
- **給与管理**: 給与形態（月給・時給）に応じた計算、支給・控除項目の自由設定
- **支払管理**: 銀行振込データ（FBデータ）作成、支払ステータス管理
- **監査・ログ**: 業務データ変更履歴の保持、ジョブ実行履歴の可視化

## システム要件

### データベース
- **PostgreSQL 13以上** (AWS RDS推奨)
- UUID v7生成関数 (`gen_uuid_v7()`) が必要
- 拡張機能: `pgcrypto`

### インフラ（本番環境想定）
- **AWS RDS**: PostgreSQLデータベース
- **AWS CloudWatch Logs**: システムログの保管
- **その他**: アプリケーションサーバー、ロードバランサー等（実装時に決定）

### 開発環境
- PostgreSQL 13以上（ローカルまたはDocker）
- マイグレーションツール（Flyway, Liquibase, Laravel Migration等）

## ドキュメント

詳細な設計ドキュメントは [`docs/`](./docs/) ディレクトリを参照してください。

### クイックスタート
1. [`docs/010_概要.md`](./docs/010_概要.md) - システム全体像を把握
2. [`docs/020_用語集.md`](./docs/020_用語集.md) - 用語の定義を確認
3. [`docs/110_業務フロー.md`](./docs/110_業務フロー.md) - 業務の流れを理解
4. [`docs/000_目次.md`](./docs/000_目次.md) - 全ドキュメント一覧

### 主要ドキュメント
- **設計**: [`docs/100_基本設計.md`](./docs/100_基本設計.md), [`docs/300_DB設計方針.md`](./docs/300_DB設計方針.md)
- **API仕様**: [`docs/500_API基本方針.md`](./docs/500_API基本方針.md)
- **ER図**: [`docs/030_ER図.mmd`](./docs/030_ER図.mmd)
- **セキュリティ**: [`docs/600_セキュリティ設計.md`](./docs/600_セキュリティ設計.md)

## セットアップ

### 1. リポジトリのクローン

```bash
git clone <repository-url>
cd AuraTime
```

### 2. データベースのセットアップ

#### ローカルPostgreSQLの場合

```bash
# データベース作成
createdb auratime

# マイグレーション実行
# （実装時にマイグレーションツールのコマンドを実行）
```

#### Dockerを使用する場合

```bash
# PostgreSQLコンテナの起動（例）
docker run -d \
  --name auratime-db \
  -e POSTGRES_DB=auratime \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD=postgres \
  -p 5432:5432 \
  postgres:13
```

### 3. 初期マイグレーションの実行

```bash
# マイグレーションファイルを実行
psql -d auratime -f database/migrations/20260101_init.sql
```

**注意**: 初期マイグレーションには以下が含まれます：
- UUID v7生成関数 (`gen_uuid_v7()`)
- 全テーブルの作成
- インデックス、制約の設定

### 4. 初期データの投入

システム管理用ユーザー（`system-bot`）の作成が必要です。詳細は [`docs/310_DDL運用.md`](./docs/310_DDL運用.md) を参照してください。

## プロジェクト構造

```
AuraTime/
├── docs/                    # 設計ドキュメント
│   ├── 000_目次.md         # ドキュメント目次
│   ├── 010_概要.md         # システム概要
│   ├── 030_ER図.mmd        # データベースER図
│   ├── 100_基本設計.md     # 基本設計
│   ├── 300_DB設計方針.md   # DB設計方針
│   ├── 500_API基本方針.md  # API基本方針
│   └── ...                 # その他の設計ドキュメント
├── database/
│   └── migrations/
│       └── 20260101_init.sql  # 初期マイグレーション
└── README.md               # このファイル
```

## 開発

### 開発環境の構築

1. データベースのセットアップ（上記「セットアップ」を参照）
2. アプリケーションコードの実装（言語・フレームワークは未定）
3. 環境変数の設定（`.env` ファイル等）
4. 開発サーバーの起動

### コーディング規約

- 実装時に決定（言語・フレームワークに応じて）

### テスト

- 詳細は [`docs/700_テスト設計.md`](./docs/700_テスト設計.md) を参照
- マルチテナント境界のテストを重点的に実施

## アーキテクチャの特徴

### マルチテナント設計
- 1つのデータベース内で `company_id` による厳密なデータ分離
- 共有スキーマ方式を採用

### ID管理モデル
- **ユーザー（USERS）**: ログイン用の認証主体
- **従業員（EMPLOYEES）**: 会社ごとの雇用契約情報
- 1つのユーザーが複数の会社に所属可能（兼務対応）

### データ保護
- 全テーブルにソフト削除機能
- 監査列（`created_by`, `updated_by`）による変更履歴の追跡
- UUID v7による推測困難なID生成

## 未決定事項

以下の技術選定は未決定です。詳細は [`docs/900_決定事項_未決定事項.md`](./docs/900_決定事項_未決定事項.md) を参照してください。

- プログラミング言語・フレームワーク
- 認証方式（OAuth2/OIDC vs 内製JWT）
- フロントエンドスタック
- 行レベルセキュリティ（RLS）の実装有無

## ライセンス

未定

## 貢献

コントリビューションガイドラインは実装時に追加予定です。
