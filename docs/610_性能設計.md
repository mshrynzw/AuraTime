# 性能設計

## 1. 目標スループット
- 打刻処理: ピーク時（出社/退社前後）に数千リクエスト/秒を遅延なく処理すること。
- 給与計算: 1万人規模の計算を数分以内で完了させること。

## 2. クエリ最適化
- **インデックス**: `company_id` を含む複合インデックスを活用し、フルテーブルスキャンを防止する。
- **N+1問題**: ORM利用時は Eager Loading を徹底し、クエリ回数を削減する。
- **大量処理**: 給与計算などは `FETCH` や `CURSOR` を使い、メモリ消費を抑えたバッチ処理を行う。

## 3. スケーラビリティ
- **Read Replica**: 参照系の重いレポート出力などはリードレプリカに分散する。
- **水平分散**: アプリケーションサーバーはステートレスに保ち、負荷に応じてオートスケーリングさせる。

## 4. キャッシュ戦略
- 頻繁に参照されるマスタデータ（休暇タイプ、給与項目名等）は Redis 等の分散キャッシュの利用を検討する。
- ただし、金額や労働時間などの整合性が重要なデータにはキャッシュを適用しない、あるいは厳密なパージ制御を行う。

