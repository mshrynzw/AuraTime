# API仕様：勤怠

## 1. 打刻 (Time Clock)

### POST `/api/v1/time-clock/events`
打刻イベントを記録します。

- **権限**: Employee
- **リクエスト**:
    ```json
    {
      "happened_at": "2025-12-18T09:00:00+09:00",
      "type": "in",
      "source": "web",
      "note": "自宅よりリモート"
    }
    ```
- **バリデーション**:
    - `type`: 必須。以下のいずれか
        - `in`: 出勤
        - `out`: 退勤
        - `break_in`: 休憩入り
        - `break_out`: 休憩戻り
    - `source`: 必須。以下のいずれか
        - `web`: PCブラウザ
        - `mobile`: スマートフォン
        - `ic_card`: ICカードリーダー（将来対応、初期実装では未対応）
        - `admin`: 管理者代行
    - `happened_at`: 必須。未来時刻不可。
    - `note`: 任意。255文字以内。
- **補足**: `company_id` および `employee_id` はログインセッションから自動付与。

## 2. 日次勤怠 (Time Records)

### GET `/api/v1/time-records`
自身の勤怠レコード一覧を取得。

- **クエリパラメータ**: `start_date`, `end_date`
- **権限**: Employee (自身), Manager (部下), Admin (全員)

### PATCH `/api/v1/time-records/{id}`
勤怠レコードを修正。

- **リクエスト**:
    ```json
    {
      "start_at": "2025-12-18T09:15:00+09:00",
      "end_at": "2025-12-18T18:15:00+09:00",
      "break_minutes": 60,
      "cost_group_id": "uuid-of-cost-center"
    }
    ```
- **制限**:
    - 既に「承認済み」または「期間締め済み」の場合は 409 Conflict。

## 3. シフト割当 (Shift Assignments)

### GET `/api/v1/shift-assignments`
特定期間のシフト割当状況を取得。

### PUT `/api/v1/shift-assignments/bulk`
マネージャーによるシフトの一括割当。
- **権限**: Manager以上
